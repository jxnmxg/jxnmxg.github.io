<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>TryHackMe: Brains</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Inter', -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, 'Helvetica Neue', Arial, sans-serif;
            background: #0a0e27;
            background-image: 
                radial-gradient(at 20% 50%, rgba(59, 130, 246, 0.08) 0px, transparent 50%),
                radial-gradient(at 80% 80%, rgba(139, 92, 246, 0.08) 0px, transparent 50%);
            min-height: 100vh;
            padding: 40px 20px;
            color: #e2e8f0;
            line-height: 1.7;
        }

        .container {
            max-width: 900px;
            margin: 0 auto;
            background: linear-gradient(135deg, rgba(30, 41, 59, 0.9) 0%, rgba(15, 23, 42, 0.95) 100%);
            border: 1px solid rgba(100, 116, 139, 0.2);
            backdrop-filter: blur(10px);
            padding: 50px;
            border-radius: 16px;
            box-shadow: 0 20px 60px rgba(0, 0, 0, 0.6);
        }

        h1 {
            color: #60a5fa;
            margin-bottom: 20px;
            font-size: 2.5rem;
            font-weight: 700;
            background: linear-gradient(135deg, #60a5fa 0%, #a78bfa 100%);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
        }

        h2 {
            color: #60a5fa;
            margin-top: 35px;
            margin-bottom: 15px;
            font-size: 1.8rem;
            font-weight: 600;
        }

        h3 {
            color: #a78bfa;
            margin-top: 25px;
            margin-bottom: 12px;
            font-size: 1.4rem;
            font-weight: 600;
        }

        p {
            margin-bottom: 15px;
            color: #cbd5e1;
            font-size: 1.05rem;
        }

        em {
            color: #94a3b8;
            font-style: italic;
        }

        a {
            color: #60a5fa;
            text-decoration: none;
            transition: color 0.3s ease;
        }

        a:hover {
            color: #a78bfa;
            text-decoration: underline;
        }

        .back-link {
            display: inline-block;
            padding: 12px 24px;
            margin-top: 30px;
            text-decoration: none;
            color: white;
            background: linear-gradient(135deg, #3b82f6 0%, #8b5cf6 100%);
            border: 1px solid rgba(96, 165, 250, 0.3);
            border-radius: 8px;
            transition: all 0.3s ease;
            font-weight: 500;
        }

        .back-link:hover {
            transform: translateY(-2px);
            box-shadow: 0 8px 20px rgba(96, 165, 250, 0.3);
            text-decoration: none;
        }

        img {
            max-width: 100%;
            height: auto;
            border: 1px solid rgba(100, 116, 139, 0.3);
            border-radius: 12px;
            margin: 20px 0;
            box-shadow: 0 8px 24px rgba(0, 0, 0, 0.4);
        }

        img.noborder {
            border: none;
            box-shadow: none;
        }

        code {
            background: rgba(15, 23, 42, 0.8);
            padding: 3px 6px;
            border-radius: 4px;
            font-family: 'Courier New', monospace;
            color: #f87171;
            font-size: 0.95em;
            border: 1px solid rgba(100, 116, 139, 0.2);
        }

        pre {
            background: rgba(15, 23, 42, 0.8);
            padding: 15px;
            border-radius: 8px;
            overflow-x: auto;
            margin: 15px 0;
            border: 1px solid rgba(100, 116, 139, 0.2);
            box-shadow: inset 0 2px 4px rgba(0, 0, 0, 0.3);
        }

        pre code {
            background: none;
            padding: 0;
            border: none;
            color: #cbd5e1;
        }

        @media (max-width: 768px) {
            .container {
                padding: 30px 20px;
            }

            h1 {
                font-size: 2rem;
            }

            h2 {
                font-size: 1.5rem;
            }
        }
    </style>
</head>
<body>
    <div class="container">
    <a href="index.html" class="back-link" style="margin-top: 0; margin-bottom: 20px;">← Back to Writeups</a>

    <h1>TryHackMe: Brains</h1>
    <p><em>April 25, 2025</em></p>

    <h2>What is the content of flag.txt in the user's home folder?</h2>

    <p>To find that answer let's do some recon first.<br>
    Let's start with a Nmap Scan</p>

    <pre><code>nmap -sC -sV -p- *IP ADDRESS*</code></pre>

    <p>And found the following</p>
    <img src="images/brains/brains-1.png" alt="Nmap Scan Result">

    <p>Ports 22, 80, 35355, and 50000 are open.<br>
    Let's see what's on port 80<br>
    Looks like the website on port 80 is nothing.<br>
    Let's check out port 50000</p>

    <p>It running team city. We can see the version it's running underneath the login button. Let's see if there is any CVEs for that version. Using metasploit I found some.<br>
    <strong>CVE-2024-27198</strong> is the one I'll be using.</p>
    <img src="images/brains/brains-2.png" alt="Metasploit CVE List">

    <p>Let's select it</p>
    <img src="images/brains/brains-3.png" alt="Metasploit Module Selected">

    <p>Let's see the options</p>
    <img src="images/brains/brains-4.png" alt="Metasploit Options">

    <p>Looks like we just have to change the RHOST and RPORT</p>

    <p>Set the RHOST to the IP of the victim</p>
    <img src="images/brains/brains-5.png" alt="Set RHOST">

    <p>Set RPORT to 50000</p>
    <img src="images/brains/brains-6.png" alt="Set RPORT">

    <p>Now run it</p>
    <img src="images/brains/brains-7.png" alt="Run Exploit">

    <p>You now have a shell! Time to find the flag<br>
    It's in /home/ubuntu</p>
    <img src="images/brains/brains-8.png" alt="Flag Location">

    <h2>Now let's move onto part 2 of the room.</h2>

    <p>You'll need basic splunk understanding for this part.<br>
    THM has some rooms that will teach you how to use it.<br>
    <a href="https://tryhackme.com/room/splunk101" target="_blank">https://tryhackme.com/room/splunk101</a></p>

    <p>Log into splunk with the info you are provided. (it may just log you in automatically after going to the IP address)<br>
    Click on search and reporting and get ready to answer the questions.</p>

    <h3>What is the name of the backdoor user which was created on the server after exploitation?</h3>
    <p>Search for this:</p>
    <pre><code>source="/var/log/auth.log" useradd</code></pre>
    <img src="images/brains/brains-9.png" alt="User Add Log">

    <h3>What is the name of the malicious-looking package installed on the server?</h3>
    <p>Search for:</p>
    <pre><code>source="/var/log/dpkg.log" install date_month="july"</code></pre>
    <p>I used that to search for new installs near the time the user from the previous question was created.</p>
    <img src="images/brains/brains-10.png" alt="Malicious Package">

    <h3>What is the name of the plugin installed on the server after successful exploitation?</h3>
    <p>Search for:</p>
    <pre><code>source="/opt/teamcity/TeamCity/logs/teamcity-activities.log" plugin</code></pre>
    <img src="images/brains/brains-11.png" alt="Plugin Installed">

    <h2>Conclusion</h2>
    <p>The red team of the room is pretty easy but the blue team can be challenging if you have no experience with splunk.<br>
    I highly suggest learning the basics of splunk as it is a very common tool in the cybersecurity world.<br>
    I hope I could help you with this walkthrough. Good luck!</p>
    <img src="images/brains/thankyou.jpg" alt="Conclusion Image" class="noborder">
    <p>Thanks for reading!</p>
    <a href="index.html" class="back-link">← Back to Writeups</a>
    </div>
</body>
</html>

